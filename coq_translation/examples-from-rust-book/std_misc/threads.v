(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.

Import Root.std.prelude.rust_2015.

Module thread := std.thread.

Definition NTHREADS : u32 := 10.

Definition main (_ : unit) : unit :=
  let children := _crate.vec.Vec::["new"] tt in
  match LangItem {| Range.start := 0; Range.end := NTHREADS; |} with
  | iter =>
    loop
      match LangItem iter with
      | None => Break
      | Some {| Some.0 := i; |} =>
        children.["push"]
          (thread.spawn
            (fun  =>
              _crate.io._print
                (_crate.fmt.Arguments::["new_v1"]
                  [ "this is thread number "; "\n" ]
                  [ _crate.fmt.ArgumentV1::["new_display"] i ]) ;;
              tt ;;
              tt)) ;;
        tt
      end ;;
      tt
      from
      for
  end ;;
  match LangItem children with
  | iter =>
    loop
      match LangItem iter with
      | None => Break
      | Some {| Some.0 := child; |} =>
        let '_ := child.["join"] in
        tt
      end ;;
      tt
      from
      for
  end.

Definition main (_ : unit) : unit := test.
